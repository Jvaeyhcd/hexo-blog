<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>RXSwift基础 | Jvaeyhcd&#39;s Note</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="RXSwift," />
  

  <meta name="description" content="概念一个观察者(Observer)订阅一个可观察序列(Observable)。观察者对Observable发射的数据或数据序列作出响应
为什么发用RxSwift一个程序通常包含着大量的各种事件的产生以及对应的处理逻辑，各种响应方法使代码更加的混乱和复杂，而RxSwift是一个统一的处理各种响应事件的方式

Observable的创建和订阅
Subjects的使用
Combination：Obser">
<meta property="og:type" content="article">
<meta property="og:title" content="RXSwift基础">
<meta property="og:url" content="http://www.jvaeyhcd.cc/2016/06/08/RXSwift基础/index.html">
<meta property="og:site_name" content="Jvaeyhcd's Note">
<meta property="og:description" content="概念一个观察者(Observer)订阅一个可观察序列(Observable)。观察者对Observable发射的数据或数据序列作出响应
为什么发用RxSwift一个程序通常包含着大量的各种事件的产生以及对应的处理逻辑，各种响应方法使代码更加的混乱和复杂，而RxSwift是一个统一的处理各种响应事件的方式

Observable的创建和订阅
Subjects的使用
Combination：Obser">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./never.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./empty.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./just.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./create.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./deferred.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./doOn.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./switch.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./takeWhile.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./skipWhile.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./toArray.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./publish.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./replay.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./catch.png">
<meta property="og:image" content="http://www.jvaeyhcd.cc/./retry.png">
<meta property="og:updated_time" content="2016-06-08T02:04:56.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RXSwift基础">
<meta name="twitter:description" content="概念一个观察者(Observer)订阅一个可观察序列(Observable)。观察者对Observable发射的数据或数据序列作出响应
为什么发用RxSwift一个程序通常包含着大量的各种事件的产生以及对应的处理逻辑，各种响应方法使代码更加的混乱和复杂，而RxSwift是一个统一的处理各种响应事件的方式

Observable的创建和订阅
Subjects的使用
Combination：Obser">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=028c63b1" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css" type="text/css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?29df66b98641fa1eb4edb792fef116c9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概念"><span class="toc-text">概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么发用RxSwift"><span class="toc-text">为什么发用RxSwift</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#消息的订阅方式"><span class="toc-text">消息的订阅方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#释放分配的资源"><span class="toc-text">释放分配的资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Observable的创建和订阅"><span class="toc-text">Observable的创建和订阅</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#never-创建即不会完成也不会发消息的Observable"><span class="toc-text">never()创建即不会完成也不会发消息的Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#empty-创建只会发送一次完成消息的Observable"><span class="toc-text">empty()创建只会发送一次完成消息的Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#just-创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息"><span class="toc-text">just()创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#of-创建可以包含任意个元素的Observable，连续相同的元素会被忽略"><span class="toc-text">of()创建可以包含任意个元素的Observable，连续相同的元素会被忽略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-可以创建自定义的Observable，在最原始的Observable基础上创建Observable"><span class="toc-text">create()可以创建自定义的Observable，在最原始的Observable基础上创建Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#range-创建一个发送一个范围的整数的Observable，发送完后发送Completed"><span class="toc-text">range()创建一个发送一个范围的整数的Observable，发送完后发送Completed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#repeatElement-创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送"><span class="toc-text">repeatElement()创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generate-创建一个可以指定规则的Observable，会发送所有满足规则的元素"><span class="toc-text">generate()创建一个可以指定规则的Observable，会发送所有满足规则的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#deferred-序列为每一个订阅者创建一个全新的Observable"><span class="toc-text">deferred()序列为每一个订阅者创建一个全新的Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#error-创建一个不发送元素的Observable，然后立即发送error并终止"><span class="toc-text">error()创建一个不发送元素的Observable，然后立即发送error并终止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#doOn-在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息"><span class="toc-text">doOn()在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toObservable-通过Array-Dictionary-或Set等SequenceType创建一个Observable"><span class="toc-text">toObservable()通过Array,Dictionary,或Set等SequenceType创建一个Observable</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subjects的使用"><span class="toc-text">Subjects的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PublishSubject向所有订阅者广播从订阅之后的事件"><span class="toc-text">PublishSubject向所有订阅者广播从订阅之后的事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息"><span class="toc-text">ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息"><span class="toc-text">BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist"><span class="toc-text">Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Combination：Observable的混合操作"><span class="toc-text">Combination：Observable的混合操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#startWith-分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈"><span class="toc-text">startWith()分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#merge-按顺序混合多个Observable为一个新Observable"><span class="toc-text">merge()按顺序混合多个Observable为一个新Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip-相当于并排的将多个Observable合并成一个新Observable"><span class="toc-text">zip()相当于并排的将多个Observable合并成一个新Observable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#combineLatest-总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合"><span class="toc-text">combineLatest()总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#switchLatest-可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息"><span class="toc-text">switchLatest()可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transforming：Observable的转换操作"><span class="toc-text">Transforming：Observable的转换操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#map-将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列"><span class="toc-text">map()将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scan-可以迭代的操作，并且可以设置一个初始的迭代值"><span class="toc-text">scan()可以迭代的操作，并且可以设置一个初始的迭代值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Filtering：Observable消息元素的过滤操作"><span class="toc-text">Filtering：Observable消息元素的过滤操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#filter-发出满足bool条件的元素"><span class="toc-text">filter()发出满足bool条件的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#distinctUntilChanged-过滤掉连续的相同元素"><span class="toc-text">distinctUntilChanged()过滤掉连续的相同元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#elementAt-只发送指定下标的元素"><span class="toc-text">elementAt()只发送指定下标的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#single-不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个-Error消息"><span class="toc-text">single()不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个 Error消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#take-仅发送从第一个元素开始指定个数的元素"><span class="toc-text">take()仅发送从第一个元素开始指定个数的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#takeLast-与take不同的是takeLast是从末尾开始"><span class="toc-text">takeLast()与take不同的是takeLast是从末尾开始</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#takeWhile-发送从头开始的满足条件的元素"><span class="toc-text">takeWhile()发送从头开始的满足条件的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#takeUntil：在与之关联的另一Observable发送元素前发送元素"><span class="toc-text">takeUntil：在与之关联的另一Observable发送元素前发送元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skip-与take相反，它是不发送"><span class="toc-text">skip()与take相反，它是不发送</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skipWhile-与takeWhile相反，它是不发送"><span class="toc-text">skipWhile()与takeWhile相反，它是不发送</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skipWhileWithIndex-只是skipWhile基础上增加了一个下标index"><span class="toc-text">skipWhileWithIndex()只是skipWhile基础上增加了一个下标index</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skipUntil-与takeUntil相反，它是之后发送"><span class="toc-text">skipUntil()与takeUntil相反，它是之后发送</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对Observable元素做运算操作"><span class="toc-text">对Observable元素做运算操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#toArray-将Observable序列转换成array并发送，然后终止"><span class="toc-text">toArray()将Observable序列转换成array并发送，然后终止</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reduce-迭代运算，通过指定初始迭代值和运算符"><span class="toc-text">reduce()迭代运算，通过指定初始迭代值和运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat-将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素"><span class="toc-text">concat()将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Connectable操作"><span class="toc-text">Connectable操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#publish-将一个普通序列转换成Connectable-Observable序列"><span class="toc-text">publish()将一个普通序列转换成Connectable Observable序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replay-相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素"><span class="toc-text">replay()相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multicast-需要传入一个subject，通过subject来管理向订阅者发送消息"><span class="toc-text">multicast()需要传入一个subject，通过subject来管理向订阅者发送消息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误处理"><span class="toc-text">错误处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#catchErrorJustReturn-通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后-Completed"><span class="toc-text">catchErrorJustReturn()通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后 Completed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#catchError-当捕获错误后会返回一个正常的Observable序列与之合并"><span class="toc-text">catchError()当捕获错误后会返回一个正常的Observable序列与之合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#retry-当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数"><span class="toc-text">retry()当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#debug"><span class="toc-text">debug</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-RXSwift基础" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">RXSwift基础</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2016.06.08</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Jvaeyhcd</span>
        </span>
      

      


      

    </div>
  </header>

  <div class="article-content">
    
      <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>一个观察者(Observer)订阅一个可观察序列(Observable)。观察者对Observable发射的数据或数据序列作出响应</p>
<h2 id="为什么发用RxSwift"><a href="#为什么发用RxSwift" class="headerlink" title="为什么发用RxSwift"></a>为什么发用RxSwift</h2><p>一个程序通常包含着大量的各种事件的产生以及对应的处理逻辑，各种响应方法使代码更加的混乱和复杂，而RxSwift是一个统一的处理各种响应事件的方式</p>
<ul>
<li>Observable的创建和订阅</li>
<li>Subjects的使用</li>
<li>Combination：Observable的混合操作</li>
<li>Transforming：Observable的转换操作</li>
<li>Filtering：Observable消息元素的过滤操作</li>
<li>对Observable元素做运算操作</li>
<li>Connectable操作</li>
<li>错误处理</li>
<li>debug</li>
</ul>
<a id="more"></a>
<h2 id="消息的订阅方式"><a href="#消息的订阅方式" class="headerlink" title="消息的订阅方式"></a>消息的订阅方式</h2><p>这些都是Observable的方法，参数都是闭包，闭包是观察者</p>
<ol>
<li>subscribe(on:(Event) -&gt; void)：订阅所有消息(Next, Error, and Completed)</li>
<li>subscribeNext((Element) -&gt; void)：只订阅Next</li>
<li>subscribeError((ErrorType) -&gt; void)：只订阅Error</li>
<li>subscribeCompleted(() -&gt; Void)：只订阅Completed</li>
<li>subscribe(onNext:(Element) -&gt; void, onError:(ErrorType) -&gt; void, onCompleted:() -&gt; Void, onDisposed:() -&gt; Void)订阅多个消息</li>
</ol>
<h2 id="释放分配的资源"><a href="#释放分配的资源" class="headerlink" title="释放分配的资源"></a>释放分配的资源</h2><p>订阅者可以通过调用.dispose()来释放分配的资源，但通过DisposeBag来管理或者通过takeUntil来自动释放更好</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">subscription.addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sequence</span><br><span class="line">    .takeUntil(<span class="keyword">self</span>.rx_deallocated)</span><br><span class="line">    .subscribe &#123;</span><br><span class="line">        <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Observable的创建和订阅"><a href="#Observable的创建和订阅" class="headerlink" title="Observable的创建和订阅"></a>Observable的创建和订阅</h2><p>Observable序列分为两类：</p>
<ul>
<li>冷：只有当有观察者订阅这个序列时，序列才发射值</li>
<li>热：序列创建时就开始发射值</li>
</ul>
<h3 id="never-创建即不会完成也不会发消息的Observable"><a href="#never-创建即不会完成也不会发消息的Observable" class="headerlink" title="never()创建即不会完成也不会发消息的Observable"></a>never()创建即不会完成也不会发消息的Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> neverSequence = <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.never()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> neverSequenceSubscription = neverSequence</span><br><span class="line">        .subscribe &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"This will never be printed"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">neverSequenceSubscription.addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><img src="./never.png" width="400/"></p>
<h3 id="empty-创建只会发送一次完成消息的Observable"><a href="#empty-创建只会发送一次完成消息的Observable" class="headerlink" title="empty()创建只会发送一次完成消息的Observable"></a>empty()创建只会发送一次完成消息的Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.empty()</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Completed</p>
<p><img src="./empty.png" width="400"></p>
<h3 id="just-创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息"><a href="#just-创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息" class="headerlink" title="just()创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息"></a>just()创建只包含一个元素的Observable，在发送一次Next消息后便发送Completed消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.just(<span class="string">"🔴"</span>)</span><br><span class="line">    .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(event)</span><br><span class="line">    &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：如果传递null给just，它将返回一个发送null消息的Observable，不要传入错误的参数，否则将会得到一个空的Observable</p>
</blockquote>
<p><code>output:</code><br>Next(🔴)<br>Completed<br><br><br><img src="./just.png" width="400"></p>
<h3 id="of-创建可以包含任意个元素的Observable，连续相同的元素会被忽略"><a href="#of-创建可以包含任意个元素的Observable，连续相同的元素会被忽略" class="headerlink" title="of()创建可以包含任意个元素的Observable，连续相同的元素会被忽略"></a>of()创建可以包含任意个元素的Observable，连续相同的元素会被忽略</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐶"</span>, <span class="string">"🐱"</span>, <span class="string">"🐭"</span>, <span class="string">"🐹"</span>)</span><br><span class="line">       .subscribeNext &#123; element <span class="keyword">in</span></span><br><span class="line">           <span class="built_in">print</span>(element)</span><br><span class="line">       &#125;</span><br><span class="line">       .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐶<br>🐱<br>🐭<br>🐹</p>
<h3 id="create-可以创建自定义的Observable，在最原始的Observable基础上创建Observable"><a href="#create-可以创建自定义的Observable，在最原始的Observable基础上创建Observable" class="headerlink" title="create()可以创建自定义的Observable，在最原始的Observable基础上创建Observable"></a>create()可以创建自定义的Observable，在最原始的Observable基础上创建Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myJust = &#123; (element: <span class="type">String</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">            observer.on(.<span class="type">Next</span>(element))</span><br><span class="line">            observer.on(.<span class="type">Completed</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> myJust(<span class="string">"🔴"</span>)</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(🔴)<br>Completed<br><br><br><img src="./create.png" width="400"><br><br></p>
<h3 id="range-创建一个发送一个范围的整数的Observable，发送完后发送Completed"><a href="#range-创建一个发送一个范围的整数的Observable，发送完后发送Completed" class="headerlink" title="range()创建一个发送一个范围的整数的Observable，发送完后发送Completed"></a>range()创建一个发送一个范围的整数的Observable，发送完后发送Completed</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.range(start: <span class="number">1</span>, <span class="built_in">count</span>: <span class="number">10</span>)</span><br><span class="line">        .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(1)<br>Next(2)<br>Next(3)<br>Next(4)<br>Next(5)<br>Next(6)<br>Next(7)<br>Next(8)<br>Next(9)<br>Next(10)<br>Completed</p>
<h3 id="repeatElement-创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送"><a href="#repeatElement-创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送" class="headerlink" title="repeatElement()创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送"></a>repeatElement()创建一个可以重复发送消息的Observable，可以指定重复的次数，未指定即无限发送</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.repeatElement(<span class="string">"🔴"</span>)</span><br><span class="line">        .take(<span class="number">3</span>)</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🔴<br>🔴<br>🔴</p>
<blockquote>
<p>注：take可以用于所有Observable指定限制元素个数</p>
</blockquote>
<h3 id="generate-创建一个可以指定规则的Observable，会发送所有满足规则的元素"><a href="#generate-创建一个可以指定规则的Observable，会发送所有满足规则的元素" class="headerlink" title="generate()创建一个可以指定规则的Observable，会发送所有满足规则的元素"></a>generate()创建一个可以指定规则的Observable，会发送所有满足规则的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"> <span class="type">Observable</span>.generate(</span><br><span class="line">            initialState: <span class="number">0</span>,</span><br><span class="line">            condition: &#123; $<span class="number">0</span> &lt; <span class="number">3</span> &#125;,</span><br><span class="line">            iterate: &#123; $<span class="number">0</span> + <span class="number">1</span> &#125;</span><br><span class="line">        )</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><strong>iterate：每次condition之后都会对当前值做一次相应迭代运算</strong></p>
<p><code>output:</code><br><br>0<br>1<br>2</p>
<h3 id="deferred-序列为每一个订阅者创建一个全新的Observable"><a href="#deferred-序列为每一个订阅者创建一个全新的Observable" class="headerlink" title="deferred()序列为每一个订阅者创建一个全新的Observable"></a>deferred()序列为每一个订阅者创建一个全新的Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">count</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> deferredSequence = <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.deferred &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Creating <span class="subst">\(<span class="built_in">count</span>)</span>"</span>)</span><br><span class="line">        <span class="built_in">count</span> += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Emitting..."</span>)</span><br><span class="line">            observer.onNext(<span class="string">"🐶"</span>)</span><br><span class="line">            observer.onNext(<span class="string">"🐱"</span>)</span><br><span class="line">            observer.onNext(<span class="string">"🐵"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">deferredSequence</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">deferredSequence</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：deferred序列只有在一个观察者订阅它的时候才执行它的创建Observable方法，产生一个全新的Observable**</p>
</blockquote>
<p><code>output:</code><br>Creating 1<br>Emitting…<br>🐶<br>🐱<br>🐵<br>Creating 2<br>Emitting…<br>🐶<br>🐱<br>🐵<br><img src="./deferred.png" width="400"><br><br></p>
<h3 id="error-创建一个不发送元素的Observable，然后立即发送error并终止"><a href="#error-创建一个不发送元素的Observable，然后立即发送error并终止" class="headerlink" title="error()创建一个不发送元素的Observable，然后立即发送error并终止"></a>error()创建一个不发送元素的Observable，然后立即发送error并终止</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.error(<span class="type">Error</span>.<span class="type">Test</span>)</span><br><span class="line">        .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Error(Test)</p>
<h3 id="doOn-在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息"><a href="#doOn-在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息" class="headerlink" title="doOn()在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息"></a>doOn()在发送元素消息前对每一个元素做指定的操作，然后返回操作前的元素消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🍎"</span>, <span class="string">"🍐"</span>, <span class="string">"🍊"</span>, <span class="string">"🍋"</span>)</span><br><span class="line">        .doOn &#123; <span class="built_in">print</span>(<span class="string">"Intercepted:"</span>, $<span class="number">0</span>) &#125;</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注： doOn(onNext:onError:onCompleted:)为不同订阅方式分别指定</p>
</blockquote>
<p><code>output:</code><br>Intercepted: Next(🍎)<br>🍎<br>Intercepted: Next(🍐)<br>🍐<br>Intercepted: Next(🍊)<br>🍊<br>Intercepted: Next(🍋)<br>🍋<br>Intercepted: Completed</p>
<p><img src="./doOn.png" width="400"><br><br></p>
<h3 id="toObservable-通过Array-Dictionary-或Set等SequenceType创建一个Observable"><a href="#toObservable-通过Array-Dictionary-或Set等SequenceType创建一个Observable" class="headerlink" title="toObservable()通过Array,Dictionary,或Set等SequenceType创建一个Observable"></a>toObservable()通过Array,Dictionary,或Set等SequenceType创建一个Observable</h3><p><br></p>
<h2 id="Subjects的使用"><a href="#Subjects的使用" class="headerlink" title="Subjects的使用"></a>Subjects的使用</h2><p>Subjects理解为observer和Observable之间的桥梁或代理，即扮演着observer又扮演着Observable，规定了添加的observer如何接收消息</p>
<h3 id="PublishSubject向所有订阅者广播从订阅之后的事件"><a href="#PublishSubject向所有订阅者广播从订阅之后的事件" class="headerlink" title="PublishSubject向所有订阅者广播从订阅之后的事件"></a>PublishSubject向所有订阅者广播从订阅之后的事件</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> subject = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"1"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🐶"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🐱"</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"2"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🅱️"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Subscription: 1 Event: Next(🐶)<br>Subscription: 1 Event: Next(🐱)<br>Subscription: 1 Event: Next(🅰️)<br>Subscription: 2 Event: Next(🅰️)<br>Subscription: 1 Event: Next(🅱️)<br>Subscription: 2 Event: Next(🅱️)</p>
<h3 id="ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息"><a href="#ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息" class="headerlink" title="ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息"></a>ReplaySubject有一个缓存机制，可以在创建时通过指定bufferSize指定缓存大小或调用buffer方法指定更详细的缓存条件来指定新添加的订阅者可以接收多少订阅前的消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> subject = <span class="type">ReplaySubject</span>&lt;<span class="type">String</span>&gt;.create(bufferSize: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"1"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🐶"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🐱"</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"2"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🅱️"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Subscription: 1 Event: Next(🐶)<br>Subscription: 1 Event: Next(🐱)<br>Subscription: 2 Event: Next(🐱)<br>Subscription: 1 Event: Next(🅰️)<br>Subscription: 2 Event: Next(🅰️)<br>Subscription: 1 Event: Next(🅱️)<br>Subscription: 2 Event: Next(🅱️)</p>
<h3 id="BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息"><a href="#BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息" class="headerlink" title="BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息"></a>BehaviorSubject向新的订阅者发送一条最近的事件，如果没有事件则发送一条默认的消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> subject = <span class="type">BehaviorSubject</span>(value: <span class="string">"🔴"</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"1"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🐶"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🐱"</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"2"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🅱️"</span>)</span><br><span class="line"></span><br><span class="line">subject.addObserver(<span class="string">"3"</span>).addDisposableTo(disposeBag)</span><br><span class="line">subject.onNext(<span class="string">"🍐"</span>)</span><br><span class="line">subject.onNext(<span class="string">"🍊"</span>)</span><br></pre></td></tr></table></figure>
<p><strong>note：以上都不会自动发送Completed当它们被释放的时候</strong></p>
<p><code>output:</code><br>Subscription: 1 Event: Next(🔴)<br>Subscription: 1 Event: Next(🐶)<br>Subscription: 1 Event: Next(🐱)<br>Subscription: 2 Event: Next(🐱)<br>Subscription: 1 Event: Next(🅰️)<br>Subscription: 2 Event: Next(🅰️)<br>Subscription: 1 Event: Next(🅱️)<br>Subscription: 2 Event: Next(🅱️)<br>Subscription: 3 Event: Next(🅱️)<br>Subscription: 1 Event: Next(🍐)<br>Subscription: 2 Event: Next(🍐)<br>Subscription: 3 Event: Next(🍐)<br>Subscription: 1 Event: Next(🍊)<br>Subscription: 2 Event: Next(🍊)<br>Subscription: 3 Event: Next(🍊)</p>
<h3 id="Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist"><a href="#Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist" class="headerlink" title="Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist"></a>Variable与BehaviorSubject的区别是在完成的时候它会自动发送一条Completed消息和调用deist</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="keyword">let</span> variable = <span class="type">Variable</span>(<span class="string">"🔴"</span>)</span><br><span class="line"></span><br><span class="line">variable.asObservable().addObserver(<span class="string">"1"</span>).addDisposableTo(disposeBag)</span><br><span class="line">variable.value = <span class="string">"🐶"</span></span><br><span class="line">variable.value = <span class="string">"🐱"</span></span><br><span class="line"></span><br><span class="line">variable.asObservable().addObserver(<span class="string">"2"</span>).addDisposableTo(disposeBag)</span><br><span class="line">variable.value = <span class="string">"🅰️"</span></span><br><span class="line">variable.value = <span class="string">"🅱️"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注:variable.asObservable()实际是获取variable中的BehaviorSubject。variable也没有onNext，而是通过value来获取或添加元素，它会添加元素到BehaviorSubject</p>
</blockquote>
<p><code>output:</code><br>Subscription: 1 Event: Next(🔴)<br>Subscription: 1 Event: Next(🐶)<br>Subscription: 1 Event: Next(🐱)<br>Subscription: 2 Event: Next(🐱)<br>Subscription: 1 Event: Next(🅰️)<br>Subscription: 2 Event: Next(🅰️)<br>Subscription: 1 Event: Next(🅱️)<br>Subscription: 2 Event: Next(🅱️)<br>Subscription: 1 Event: Completed<br>Subscription: 2 Event: Completed</p>
<h2 id="Combination：Observable的混合操作"><a href="#Combination：Observable的混合操作" class="headerlink" title="Combination：Observable的混合操作"></a>Combination：Observable的混合操作</h2><h3 id="startWith-分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈"><a href="#startWith-分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈" class="headerlink" title="startWith()分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈"></a>startWith()分为原Observable和新Observable，并且在发送原Observable元素前会先发送完新Observable元素，有点像栈</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"> <span class="type">Observable</span>.of(<span class="string">"🐶"</span>, <span class="string">"🐱"</span>, <span class="string">"🐭"</span>, <span class="string">"🐹"</span>)</span><br><span class="line">     .startWith(<span class="string">"1️⃣"</span>)</span><br><span class="line">     .startWith(<span class="string">"2️⃣"</span>)</span><br><span class="line">     .startWith(<span class="string">"3️⃣"</span>, <span class="string">"🅰️"</span>, <span class="string">"🅱️"</span>)</span><br><span class="line">     .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">     .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>3️⃣<br>🅰️<br>🅱️<br>2️⃣<br>1️⃣<br>🐶<br>🐱<br>🐭<br>🐹<br><a href="http://reactivex.io/documentation/operators/startwith.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/startwith.html</a></p>
<h3 id="merge-按顺序混合多个Observable为一个新Observable"><a href="#merge-按顺序混合多个Observable为一个新Observable" class="headerlink" title="merge()按顺序混合多个Observable为一个新Observable"></a>merge()按顺序混合多个Observable为一个新Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject1 = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> subject2 = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> subject3 = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(subject1, subject2, subject3)</span><br><span class="line">    .merge()</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🅱️"</span>)</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"①"</span>)</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"②"</span>)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🆎"</span>)</span><br><span class="line"></span><br><span class="line">subject3.onNext(<span class="string">"🐱"</span>)</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"③"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🅰️<br>🅱️<br>①<br>②<br>🆎<br>③<br><a href="http://reactivex.io/documentation/operators/merge.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/merge.html</a></p>
<h3 id="zip-相当于并排的将多个Observable合并成一个新Observable"><a href="#zip-相当于并排的将多个Observable合并成一个新Observable" class="headerlink" title="zip()相当于并排的将多个Observable合并成一个新Observable"></a>zip()相当于并排的将多个Observable合并成一个新Observable</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> stringSubject = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> intSubject = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.<span class="built_in">zip</span>(stringSubject, intSubject) &#123; stringElement, intElement <span class="keyword">in</span></span><br><span class="line">    <span class="string">"<span class="subst">\(stringElement)</span> <span class="subst">\(intElement)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">stringSubject.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line">stringSubject.onNext(<span class="string">"🅱️"</span>)</span><br><span class="line"></span><br><span class="line">intSubject.onNext(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">intSubject.onNext(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">stringSubject.onNext(<span class="string">"🆎"</span>)</span><br><span class="line">intSubject.onNext(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🅰️ 1<br>🅱️ 2<br>🆎 3</p>
<p><a href="http://reactivex.io/documentation/operators/zip.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/zip.html</a><br><br></p>
<h3 id="combineLatest-总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合"><a href="#combineLatest-总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合" class="headerlink" title="combineLatest()总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合"></a>combineLatest()总是将某个Observable发出的最新元素与其他Observable的最后发出的元素混合</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> stringSubject = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> intSubject = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.combineLatest(stringSubject, intSubject) &#123; stringElement, intElement <span class="keyword">in</span></span><br><span class="line">        <span class="string">"<span class="subst">\(stringElement)</span> <span class="subst">\(intElement)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">stringSubject.onNext(<span class="string">"🅰️"</span>)</span><br><span class="line"></span><br><span class="line">stringSubject.onNext(<span class="string">"🅱️"</span>)</span><br><span class="line">intSubject.onNext(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">intSubject.onNext(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">stringSubject.onNext(<span class="string">"🆎"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🅱️ 1<br>🅱️ 2<br>🆎 2<br><a href="http://reactivex.io/documentation/operators/combinelatest.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/combinelatest.html</a></p>
<p>在数组上的应用：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> stringObservable = <span class="type">Observable</span>.just(<span class="string">"❤️"</span>)</span><br><span class="line"><span class="keyword">let</span> fruitObservable = [<span class="string">"🍎"</span>, <span class="string">"🍐"</span>, <span class="string">"🍊"</span>].toObservable()</span><br><span class="line"><span class="keyword">let</span> animalObservable = <span class="type">Observable</span>.of(<span class="string">"🐶"</span>, <span class="string">"🐱"</span>, <span class="string">"🐭"</span>, <span class="string">"🐹"</span>)</span><br><span class="line"></span><br><span class="line">[stringObservable, fruitObservable, animalObservable].combineLatest &#123;</span><br><span class="line">        <span class="string">"<span class="subst">\($<span class="number">0</span>[<span class="number">0</span>])</span> <span class="subst">\($<span class="number">0</span>[<span class="number">1</span>])</span> <span class="subst">\($<span class="number">0</span>[<span class="number">2</span>])</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><strong>note：所有集合的类型必须一样</strong></p>
<p><code>output:</code><br>❤️ 🍊 🐶<br>❤️ 🍊 🐱<br>❤️ 🍊 🐭<br>❤️ 🍊 🐹</p>
<h3 id="switchLatest-可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息"><a href="#switchLatest-可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息" class="headerlink" title="switchLatest()可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息"></a>switchLatest()可以将多个Observable序列合并成一个一维的Observable序列，只合并当前关注的Observable序列最近的消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject1 = <span class="type">BehaviorSubject</span>(value: <span class="string">"⚽️"</span>)</span><br><span class="line"><span class="keyword">let</span> subject2 = <span class="type">BehaviorSubject</span>(value: <span class="string">"🍎"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> variable = <span class="type">Variable</span>(subject1)</span><br><span class="line"></span><br><span class="line">variable.asObservable()</span><br><span class="line">    .switchLatest()</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🏈"</span>)</span><br><span class="line">subject1.onNext(<span class="string">"🏀"</span>)</span><br><span class="line"></span><br><span class="line">variable.value = subject2</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"⚾️"</span>)</span><br><span class="line">subject1.onNext(<span class="string">"🎾"</span>)</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"🍐"</span>)</span><br><span class="line"></span><br><span class="line">variable.value = subject1</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>⚽️<br>🏈<br>🏀<br>🍎<br>🍐<br>🎾<br><strong>note：⚽️ 被忽略</strong><br><br><br><img src="./switch.png" width="400"><br><br></p>
<h2 id="Transforming：Observable的转换操作"><a href="#Transforming：Observable的转换操作" class="headerlink" title="Transforming：Observable的转换操作"></a>Transforming：Observable的转换操作</h2><h3 id="map-将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列"><a href="#map-将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列" class="headerlink" title="map()将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列"></a>map()将闭包操作应用到一个被观察序列的所有元素上，然后返回一个新的被观察序列</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    .<span class="built_in">map</span> &#123; $<span class="number">0</span> * $<span class="number">0</span> &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>1<br>4<br>9<br><a href="http://reactivex.io/documentation/operators/map.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/map.html</a></p>
<h3 id="scan-可以迭代的操作，并且可以设置一个初始的迭代值"><a href="#scan-可以迭代的操作，并且可以设置一个初始的迭代值" class="headerlink" title="scan()可以迭代的操作，并且可以设置一个初始的迭代值"></a>scan()可以迭代的操作，并且可以设置一个初始的迭代值</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">10</span>, <span class="number">100</span>, <span class="number">1000</span>)</span><br><span class="line">    .scan(<span class="number">1</span>) &#123; aggregateValue, newValue <span class="keyword">in</span></span><br><span class="line">        aggregateValue + newValue</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>11<br>111<br>1111<br><a href="http://reactivex.io/documentation/operators/scan.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/scan.html</a></p>
<h2 id="Filtering：Observable消息元素的过滤操作"><a href="#Filtering：Observable消息元素的过滤操作" class="headerlink" title="Filtering：Observable消息元素的过滤操作"></a>Filtering：Observable消息元素的过滤操作</h2><h3 id="filter-发出满足bool条件的元素"><a href="#filter-发出满足bool条件的元素" class="headerlink" title="filter()发出满足bool条件的元素"></a>filter()发出满足bool条件的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(</span><br><span class="line">    <span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>,</span><br><span class="line">    <span class="string">"🐸"</span>, <span class="string">"🐱"</span>, <span class="string">"🐰"</span>,</span><br><span class="line">    <span class="string">"🐹"</span>, <span class="string">"🐸"</span>, <span class="string">"🐱"</span>)</span><br><span class="line">    .<span class="built_in">filter</span> &#123;</span><br><span class="line">        $<span class="number">0</span> == <span class="string">"🐱"</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐱<br>🐱<br>🐱<br><a href="http://reactivex.io/documentation/operators/filter.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/filter.html</a></p>
<h3 id="distinctUntilChanged-过滤掉连续的相同元素"><a href="#distinctUntilChanged-过滤掉连续的相同元素" class="headerlink" title="distinctUntilChanged()过滤掉连续的相同元素"></a>distinctUntilChanged()过滤掉连续的相同元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐷"</span>, <span class="string">"🐱"</span>, <span class="string">"🐱"</span>, <span class="string">"🐱"</span>, <span class="string">"🐵"</span>, <span class="string">"🐱"</span>)</span><br><span class="line">    .distinctUntilChanged()</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐱<br>🐷<br>🐱<br>🐵<br>🐱<br><a href="http://reactivex.io/documentation/operators/distinct.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/distinct.html</a></p>
<h3 id="elementAt-只发送指定下标的元素"><a href="#elementAt-只发送指定下标的元素" class="headerlink" title="elementAt()只发送指定下标的元素"></a>elementAt()只发送指定下标的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .elementAt(<span class="number">3</span>)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐸<br><a href="http://reactivex.io/documentation/operators/elementat.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/elementat.html</a></p>
<h3 id="single-不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个-Error消息"><a href="#single-不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个-Error消息" class="headerlink" title="single()不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个 Error消息"></a>single()不传参数则发送Observable的第一个元素，否则为满足条件表达式的第一个元素，如果没有发送一个确切的元素，将发送一个 Error消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .single&#123; $<span class="number">0</span> &lt;= <span class="number">6</span>&#125;<span class="comment">//如果是==这种确切的判断，将没有Error消息而是Completed消息</span></span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(1)<br>Error(Sequence contains more than one element.)</p>
<h3 id="take-仅发送从第一个元素开始指定个数的元素"><a href="#take-仅发送从第一个元素开始指定个数的元素" class="headerlink" title="take()仅发送从第一个元素开始指定个数的元素"></a>take()仅发送从第一个元素开始指定个数的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .take(<span class="number">3</span>)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐱<br>🐰<br>🐶<br><a href="http://reactivex.io/documentation/operators/take.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/take.html</a></p>
<h3 id="takeLast-与take不同的是takeLast是从末尾开始"><a href="#takeLast-与take不同的是takeLast是从末尾开始" class="headerlink" title="takeLast()与take不同的是takeLast是从末尾开始"></a>takeLast()与take不同的是takeLast是从末尾开始</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .takeLast(<span class="number">3</span>)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐸<br>🐷<br>🐵<br><a href="http://reactivex.io/documentation/operators/takelast.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/takelast.html</a></p>
<h3 id="takeWhile-发送从头开始的满足条件的元素"><a href="#takeWhile-发送从头开始的满足条件的元素" class="headerlink" title="takeWhile()发送从头开始的满足条件的元素"></a>takeWhile()发送从头开始的满足条件的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">    .takeWhile &#123; $<span class="number">0</span> &lt; <span class="number">4</span> &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>1<br>2<br>3<br><img src="./takeWhile.png" width="400"><br><br></p>
<h3 id="takeUntil：在与之关联的另一Observable发送元素前发送元素"><a href="#takeUntil：在与之关联的另一Observable发送元素前发送元素" class="headerlink" title="takeUntil：在与之关联的另一Observable发送元素前发送元素"></a>takeUntil：在与之关联的另一Observable发送元素前发送元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourceSequence = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> referenceSequence = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">sourceSequence</span><br><span class="line">    .takeUntil(referenceSequence)</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">sourceSequence.onNext(<span class="string">"🐱"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐰"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐶"</span>)</span><br><span class="line"></span><br><span class="line">referenceSequence.onNext(<span class="string">"🔴"</span>)</span><br><span class="line"></span><br><span class="line">sourceSequence.onNext(<span class="string">"🐸"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐷"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐵"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(🐱)<br>Next(🐰)<br>Next(🐶)<br>Completed<br><br><a href="http://reactivex.io/documentation/operators/takeuntil.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/takeuntil.html</a></p>
<h3 id="skip-与take相反，它是不发送"><a href="#skip-与take相反，它是不发送" class="headerlink" title="skip()与take相反，它是不发送"></a>skip()与take相反，它是不发送</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .skip(<span class="number">2</span>)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐶<br>🐸<br>🐷<br>🐵<br><a href="http://reactivex.io/documentation/operators/skip.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/skip.html</a></p>
<h3 id="skipWhile-与takeWhile相反，它是不发送"><a href="#skipWhile-与takeWhile相反，它是不发送" class="headerlink" title="skipWhile()与takeWhile相反，它是不发送"></a>skipWhile()与takeWhile相反，它是不发送</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">    .skipWhile &#123; $<span class="number">0</span> &lt; <span class="number">4</span> &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>4<br>5<br>6<br><br><br><img src="./skipWhile.png" width="400"><br><br></p>
<h3 id="skipWhileWithIndex-只是skipWhile基础上增加了一个下标index"><a href="#skipWhileWithIndex-只是skipWhile基础上增加了一个下标index" class="headerlink" title="skipWhileWithIndex()只是skipWhile基础上增加了一个下标index"></a>skipWhileWithIndex()只是skipWhile基础上增加了一个下标index</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="string">"🐱"</span>, <span class="string">"🐰"</span>, <span class="string">"🐶"</span>, <span class="string">"🐸"</span>, <span class="string">"🐷"</span>, <span class="string">"🐵"</span>)</span><br><span class="line">    .skipWhileWithIndex &#123; element, index <span class="keyword">in</span></span><br><span class="line">        index &lt; <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐸<br>🐷<br>🐵</p>
<h3 id="skipUntil-与takeUntil相反，它是之后发送"><a href="#skipUntil-与takeUntil相反，它是之后发送" class="headerlink" title="skipUntil()与takeUntil相反，它是之后发送"></a>skipUntil()与takeUntil相反，它是之后发送</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourceSequence = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> referenceSequence = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">sourceSequence</span><br><span class="line">    .skipUntil(referenceSequence)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">sourceSequence.onNext(<span class="string">"🐱"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐰"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐶"</span>)</span><br><span class="line"></span><br><span class="line">referenceSequence.onNext(<span class="string">"🔴"</span>)</span><br><span class="line"></span><br><span class="line">sourceSequence.onNext(<span class="string">"🐸"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐷"</span>)</span><br><span class="line">sourceSequence.onNext(<span class="string">"🐵"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🐸<br>🐷<br>🐵<br><a href="http://reactivex.io/documentation/operators/skipuntil.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/skipuntil.html</a></p>
<h2 id="对Observable元素做运算操作"><a href="#对Observable元素做运算操作" class="headerlink" title="对Observable元素做运算操作"></a>对Observable元素做运算操作</h2><h3 id="toArray-将Observable序列转换成array并发送，然后终止"><a href="#toArray-将Observable序列转换成array并发送，然后终止" class="headerlink" title="toArray()将Observable序列转换成array并发送，然后终止"></a>toArray()将Observable序列转换成array并发送，然后终止</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.range(start: <span class="number">1</span>, <span class="built_in">count</span>: <span class="number">10</span>)</span><br><span class="line">    .toArray()</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])<br>Completed<br><br><br><img src="./toArray.png" width="400"><br><br></p>
<h3 id="reduce-迭代运算，通过指定初始迭代值和运算符"><a href="#reduce-迭代运算，通过指定初始迭代值和运算符" class="headerlink" title="reduce()迭代运算，通过指定初始迭代值和运算符"></a>reduce()迭代运算，通过指定初始迭代值和运算符</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Observable</span>.of(<span class="number">10</span>, <span class="number">100</span>, <span class="number">1000</span>)</span><br><span class="line">    .<span class="built_in">reduce</span>(<span class="number">1</span>, accumulator: +)</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code>=<br>1111<br><a href="http://reactivex.io/documentation/operators/reduce.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/reduce.html</a></p>
<h3 id="concat-将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素"><a href="#concat-将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素" class="headerlink" title="concat()将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素"></a>concat()将一个Observable序列的内部Observable序列串联起来，且同一时间只操作一个序列，只有当前序列Completed后，才开始串联下一个序列的前一个元素及之后的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject1 = <span class="type">BehaviorSubject</span>(value: <span class="string">"🍎"</span>)</span><br><span class="line"><span class="keyword">let</span> subject2 = <span class="type">BehaviorSubject</span>(value: <span class="string">"🐶"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> variable = <span class="type">Variable</span>(subject1)</span><br><span class="line"></span><br><span class="line">variable.asObservable()</span><br><span class="line">    .concat()</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🍐"</span>)</span><br><span class="line">subject1.onNext(<span class="string">"🍊"</span>)</span><br><span class="line"></span><br><span class="line">variable.value = subject2</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"I would be ignored"</span>)</span><br><span class="line">subject2.onNext(<span class="string">"🐱"</span>)</span><br><span class="line"></span><br><span class="line">subject1.onNext(<span class="string">"🍹"</span>)</span><br><span class="line">subject1.onCompleted()</span><br><span class="line"></span><br><span class="line">subject2.onNext(<span class="string">"🐭"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(🍎)<br>Next(🍐)<br>Next(🍊)<br>Next(🍹)<br>Next(🐱)<br>Next(🐭)<br><a href="http://reactivex.io/documentation/operators/concat.html" target="_blank" rel="external">http://reactivex.io/documentation/operators/concat.html</a></p>
<h2 id="Connectable操作"><a href="#Connectable操作" class="headerlink" title="Connectable操作"></a>Connectable操作</h2><p>Connectable操作，Connectable Observable操作跟普通的Observable区别在于，Connectable Observable只有在它们的connect()方法调用后才开始发送元素，因此可以等到所有订阅者都订阅后才开始发送元素，有点像事务一样</p>
<h3 id="publish-将一个普通序列转换成Connectable-Observable序列"><a href="#publish-将一个普通序列转换成Connectable-Observable序列" class="headerlink" title="publish()将一个普通序列转换成Connectable Observable序列"></a>publish()将一个普通序列转换成Connectable Observable序列</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">printExampleHeader(#function)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> intSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .publish()</span><br><span class="line"></span><br><span class="line"><span class="number">_</span> = intSequence</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 1:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">2</span>) &#123; intSequence.connect() &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">4</span>) &#123;</span><br><span class="line">    <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 2:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">6</span>) &#123;</span><br><span class="line">    <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 3:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br></pre></td></tr></table></figure>
<p><code>output:</code></p>
<p>delay 2</p>
<p>Subscription 1:, Event: 0<br>Subscription 1:, Event: 1<br>Subscription 2:, Event: 1<br>Subscription 1:, Event: 2<br>Subscription 2:, Event: 2<br>Subscription 1:, Event: 3<br>Subscription 2:, Event: 3<br>Subscription 3:, Event: 3<br>Subscription 1:, Event: 4<br>Subscription 2:, Event: 4<br>Subscription 3:, Event: 4<br><br><br><img src="./publish.png" width="400"><br><br></p>
<h3 id="replay-相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素"><a href="#replay-相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素" class="headerlink" title="replay()相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素"></a>replay()相对于publish增加了bufferSize指定对元素的缓存大小，这样新加入的订阅者可以获取相应个数的已发送的元素</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">printExampleHeader(#function)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> intSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .replay(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">_</span> = intSequence</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 1:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">2</span>) &#123; intSequence.connect() &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">4</span>) &#123;</span><br><span class="line">    <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 2:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">8</span>) &#123;</span><br><span class="line">    <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subscription 3:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>output:</code></p>
<p>delay 2</p>
<p>Subscription 1:, Event: 0<br>Subscription 2:, Event: 0<br>Subscription 1:, Event: 1<br>Subscription 2:, Event: 1<br>Subscription 1:, Event: 2<br>Subscription 2:, Event: 2<br>Subscription 1:, Event: 3<br>Subscription 2:, Event: 3<br>Subscription 1:, Event: 4<br>Subscription 2:, Event: 4<br>Subscription 3:, Event: 0<br>Subscription 3:, Event: 1<br>Subscription 3:, Event: 2<br>Subscription 3:, Event: 3<br>Subscription 3:, Event: 4<br>Subscription 1:, Event: 5<br>Subscription 2:, Event: 5<br>Subscription 3:, Event: 5<br><br><br><img src="./replay.png" width="400"><br><br></p>
<h3 id="multicast-需要传入一个subject，通过subject来管理向订阅者发送消息"><a href="#multicast-需要传入一个subject，通过subject来管理向订阅者发送消息" class="headerlink" title="multicast()需要传入一个subject，通过subject来管理向订阅者发送消息"></a>multicast()需要传入一个subject，通过subject来管理向订阅者发送消息</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">printExampleHeader(#function)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="number">_</span> = subject</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"Subject: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> intSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">    .multicast(subject)</span><br><span class="line"></span><br><span class="line"><span class="number">_</span> = intSequence</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"\tSubscription 1:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">2</span>) &#123; intSequence.connect() &#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">4</span>) &#123;</span><br><span class="line">     <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"\tSubscription 2:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">delay(<span class="number">6</span>) &#123;</span><br><span class="line">     <span class="number">_</span> = intSequence</span><br><span class="line">        .subscribeNext &#123; <span class="built_in">print</span>(<span class="string">"\tSubscription 3:, Event: <span class="subst">\($<span class="number">0</span>)</span>"</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>output:</code></p>
<p>delay 2</p>
<p>Subject: 0<br>Subscription 1:, Event: 0<br> Subject: 1<br>Subscription 1:, Event: 1<br>Subscription 2:, Event: 1<br> Subject: 2<br>Subscription 1:, Event: 2<br>Subscription 2:, Event: 2<br> Subject: 3<br>Subscription 1:, Event: 3<br>Subscription 2:, Event: 3<br>Subscription 3:, Event: 3<br> Subject: 4<br>Subscription 1:, Event: 4<br>Subscription 2:, Event: 4<br>Subscription 3:, Event: 4<br> Subject: 5<br>Subscription 1:, Event: 5<br>Subscription 2:, Event: 5<br>Subscription 3:, Event: 5</p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><h3 id="catchErrorJustReturn-通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后-Completed"><a href="#catchErrorJustReturn-通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后-Completed" class="headerlink" title="catchErrorJustReturn()通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后 Completed"></a>catchErrorJustReturn()通过返回一个只发送一个元素的Observable序列来捕获错误信息，然后 Completed</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sequenceThatFails = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">sequenceThatFails</span><br><span class="line">    .catchErrorJustReturn(<span class="string">"😊"</span>)</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">sequenceThatFails.onNext(<span class="string">"😬"</span>)</span><br><span class="line">sequenceThatFails.onNext(<span class="string">"😨"</span>)</span><br><span class="line">sequenceThatFails.onNext(<span class="string">"😡"</span>)</span><br><span class="line">sequenceThatFails.onNext(<span class="string">"🔴"</span>)</span><br><span class="line">sequenceThatFails.onError(<span class="type">Error</span>.<span class="type">Test</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(😬)<br>Next(😨)<br>Next(😡)<br>Next(🔴)<br>Next(😊)<br>Completed</p>
<h3 id="catchError-当捕获错误后会返回一个正常的Observable序列与之合并"><a href="#catchError-当捕获错误后会返回一个正常的Observable序列与之合并" class="headerlink" title="catchError()当捕获错误后会返回一个正常的Observable序列与之合并"></a>catchError()当捕获错误后会返回一个正常的Observable序列与之合并</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sequenceThatErrors = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> recoverySequence = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line">sequenceThatErrors</span><br><span class="line">    .catchError &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error:"</span>, $<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> recoverySequence</span><br><span class="line">    &#125;</span><br><span class="line">    .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br><span class="line"></span><br><span class="line">sequenceThatErrors.onNext(<span class="string">"😬"</span>)</span><br><span class="line">sequenceThatErrors.onNext(<span class="string">"😨"</span>)</span><br><span class="line">sequenceThatErrors.onNext(<span class="string">"😡"</span>)</span><br><span class="line">sequenceThatErrors.onNext(<span class="string">"🔴"</span>)</span><br><span class="line">sequenceThatErrors.onError(<span class="type">Error</span>.<span class="type">Test</span>)</span><br><span class="line"></span><br><span class="line">recoverySequence.onNext(<span class="string">"😊"</span>)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>Next(😬)<br>Next(😨)<br>Next(😡)<br>Next(🔴)<br>Error: Test<br>Next(😊)<br><br><br><img src="./catch.png" width="400"><br><br></p>
<h3 id="retry-当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数"><a href="#retry-当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数" class="headerlink" title="retry()当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数"></a>retry()当遇到error后发送一条error消息然后重新重头发送元素，通过传入一个整数可以指定重复次数</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sequenceThatErrors = <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.create &#123; observer <span class="keyword">in</span></span><br><span class="line">    observer.onNext(<span class="string">"🍎"</span>)</span><br><span class="line">    observer.onNext(<span class="string">"🍐"</span>)</span><br><span class="line">    observer.onNext(<span class="string">"🍊"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">count</span> == <span class="number">1</span> &#123;</span><br><span class="line">        observer.onError(<span class="type">Error</span>.<span class="type">Test</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error encountered"</span>)</span><br><span class="line">        <span class="built_in">count</span> += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    observer.onNext(<span class="string">"🐶"</span>)</span><br><span class="line">    observer.onNext(<span class="string">"🐱"</span>)</span><br><span class="line">    observer.onNext(<span class="string">"🐭"</span>)</span><br><span class="line">    observer.onCompleted()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sequenceThatErrors</span><br><span class="line">    .retry()</span><br><span class="line">    .subscribeNext &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">    .addDisposableTo(disposeBag)</span><br></pre></td></tr></table></figure>
<p><code>output:</code><br>🍎<br>🍐<br>🍊<br>Error encountered<br>🍎<br>🍐<br>🍊<br>🐶<br>🐱<br>🐭<br><br><br><img src="./retry.png" width="400"><br><br></p>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><ol>
<li>debug()会打印详细的信息</li>
<li>RxSwift.resourceCount()打印资源分配计数</li>
</ol>
<blockquote>
<p>注：不要在Release builds中使用</p>
</blockquote>

    
  </div>
</article>

</div>


  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，打赏Jvaeyhcd</div>
        <ul class="theme.donation.items.length">
        
          <li class="item">
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>




  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    
  <section class="duoshuo-comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="" data-title="RXSwift基础" data-url="http://www.jvaeyhcd.cc/2016/06/08/RXSwift基础/index.html"></div>
    <!-- 多说评论框 end -->
  </section>




  <script type="text/javascript">
  var duoshuoQuery = {short_name:"jvaeyhcd"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>


  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
